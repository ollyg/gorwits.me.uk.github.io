<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<title>MythTV Transcoding (3): Transcoding for iPad Playback | Cats and Code</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="../../../../wp-content/themes/2010-weaver/style.css" />
<link rel="pingback" href="../../../../xmlrpc.php" />
<link rel="alternate" type="application/rss+xml" title="Cats and Code &raquo; Feed" href="../../../../index.html%3Ffeed=rss2" />
<link rel="alternate" type="application/rss+xml" title="Cats and Code &raquo; Comments Feed" href="../../../../comments/feed/index.html" />

            <script type="text/javascript">//<![CDATA[
            // Google Analytics for WordPress by Yoast v4.3.3 | http://yoast.com/wordpress/google-analytics/
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-41472490-1']);
				            _gaq.push(['_trackPageview']);
            (function () {
                var ga = document.createElement('script');
                ga.type = 'text/javascript';
                ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';

                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(ga, s);
            })();
            //]]></script>
			<link rel="alternate" type="application/rss+xml" title="Cats and Code &raquo; MythTV Transcoding (3): Transcoding for iPad Playback Comments Feed" href="feed/index.html" />
<script type='text/javascript' src='http://blog.gorwits.me.uk/wp-includes/js/comment-reply.min.js?ver=3.6.1'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../../xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://blog.gorwits.me.uk/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Is it silly that tmux is fun?' href='../../../../index.html%3Fp=575.html' />
<link rel='next' title='MythTV Transcoding (4): Add an H.264 Transcode Job' href='../../../../index.html%3Fp=614.html' />
<meta name="generator" content="WordPress 3.6.1" />
<link rel='canonical' href='../../../../index.html%3Fp=577.html' />
<link rel='shortlink' href='../../../../index.html%3Fp=577.html' />
<link rel="stylesheet" type="text/css" href="../../../../wp-content/plugins/wp-recaptcha/recaptcha.css" /><!-- This site is using 2010 Weaver V1.5.4 subtheme: Twenty Ten -->
<meta name="description" content=" Cats and Code - Hello, Welcome. " />
<meta name="keywords" content="Cats and Code blog, Cats and Code" />
<link rel="stylesheet" type="text/css" media="all" href="../../../../wp-content/blog.gorwits.me.uk/weaver-subthemes/style-weaver.css" />
<!-- Add your own CSS snippets between the style tags. -->
<style type="text/css">
</style>
<!-- End of Weaver options -->
<style type="text/css" id="syntaxhighlighteranchor"></style>
</head>

<body class="single single-post postid-577 single-format-standard">
<div id="wrapper" class="hfeed">

    
    <div id="header">
	<div id="masthead">
	    <div id="branding" role="banner">
		<div id="ttw-site-logo"></div>
		<div id="ttw-site-logo-link" onclick="location.href='http://blog.gorwits.me.uk/';" style="cursor:pointer;"></div>
				    		    <div id="site-title">
		    <span>
			<a href="../../../../index.html" title="Cats and Code" rel="home">Cats and Code</a>
		    </span>
		    </div>
		<div id="site-description">by Oliver Gorwits</div>
						
		<div id="access2" role="navigation">
		    <div class="skip-link screen-reader-text"><a href="../../../../index.html%3Fp=577.html#content" title="Skip to content">Skip to content</a></div>
		    
		</div><!-- #access2 -->

				
	    </div><!-- #branding -->
		
	    <div id="access" role="navigation">
		    		<div class="skip-link screen-reader-text"><a href="../../../../index.html%3Fp=577.html#content" title="Skip to content">Skip to content</a></div>

		    		    <div class="menu"><ul><li ><a href="../../../../index.html" title="Home">Home</a></li><li class="page_item page-item-13"><a href="../../../../about/index.html">About</a></li></ul></div>
	    </div><!-- #access -->
				
	</div><!-- #masthead -->
    </div><!-- #header -->

    
    <div id="main">

	<div id="container">
		    <div id="content" role="main">


		<div id="nav-above" class="navigation">
		    <div class="nav-previous"><a href="../../../../index.html%3Fp=575.html" rel="prev"><span class="meta-nav">&larr;</span> Is it silly that tmux is fun?</a></div>
		    <div class="nav-next"><a href="../../../../index.html%3Fp=614.html" rel="next">MythTV Transcoding (4): Add an H.264 Transcode Job <span class="meta-nav">&rarr;</span></a></div>
		</div><!-- #nav-above -->

		<div id="post-577" class="post-577 post type-post status-publish format-standard hentry category-mythtv category-transcoding">
		    <h1 class="entry-title">MythTV Transcoding (3): Transcoding for iPad Playback</h1>
			<div class="entry-meta">
			    <span class="meta-prep meta-prep-author">Posted on</span> <a href="../../../../index.html%3Fp=577.html" title="17:17" rel="bookmark"><span class="entry-date">September 4, 2011</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="../../../../author/oliver/index.html" title="View all posts by Oliver Gorwits">Oliver Gorwits</a></span>			</div><!-- .entry-meta -->
			<div class="entry-content">
			    <p>Iâ€™m doing a series of posts here on automated transcoding of recordings in MythTV. The idea is to explain the basics, then evolve the design to end up with recordings suitable for playback on the iPad, which is a little more advanced.</p>
<ul>
<li><em>The complete series of articles is available atÂ <a href="../../../../category/transcoding/index.html"  target="_self">this page</a></em></li>
</ul>
<p><a href="../../../../index.html%3Fp=390.html"  target="_blank">Last time</a> I showed where you go in MythTV to edit the default job settings, and what happens when you hit the Transcode button in MythWeb or let MythTV transcode automatically after recording.</p>
<p>Today I&#8217;m going to continue the series by leaving MythTV to one side, and showing how to create a transcoded recording suitable for playback on an iPad (or other Apple device &#8211; iPod, iPhone, Mac OS X, etc). Next time we&#8217;ll incorporate this into MythWeb for the final result.</p>
<p>Before that, let&#8217;s look at the different ways that playback on Apple platforms might be achieved (more suggestions are welcome, in the comments):</p>
<ul>
<li>Install the <a href="http://sourceforge.net/projects/mythtvformacosx/files/" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://sourceforge.net']);" target="_blank">MythFrontend</a> application natively onto an OS X device.</li>
<li>Install the <a href="http://www.vlcmediaplayer.org/" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://www.vlcmediaplayer.org']);" target="_blank">VLC Media Player</a> onto an OS X device (as it can handle the <em>ASX Stream</em> link in MythWeb) &#8211; in fact this is what I do on my own desktop Mac.</li>
<li>Install <a href="http://code.google.com/p/mythpodcaster/" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://code.google.com']);" target="_blank">MythPodcaster</a>, a Transcoder and RSS publisher, and subscribe to transcoded recordings in iTunes (leads to syncing them to the iPad).</li>
<li>Create a MythTV Job to transcode into <a href="http://www.apple.com/quicktime/what-is/" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://www.apple.com']);" target="_blank">H.264</a> format (compatible with all Apple platforms), and add links to the generated files in MythWeb.</li>
</ul>
<p>It&#8217;s the last of these which I&#8217;m going to cover in this article. However an honourable mention must be made of MythPodcaster. First, most of the work here is taken from looking at what that excellent tool does. Second, if you don&#8217;t want to mess about editing MythWeb, then MythPodcaster has its own web interface for not only managing transcode schedules and profiles, but also browsing and playback. It really is an excellent tool I recommend you check out.</p>
<p>Each MythTV user job is configured as a command which can be executed at the shell command-line. That means the first thing to do is get transcoding working at the command-line for ourselves. The tool for this is <code>ffmpeg</code>, but we must compile a special version which can output H.264. The following instructions are for an Ubuntu system and based on the MythPodcaster <a href="http://code.google.com/p/mythpodcaster/wiki/InstallationOnMythBuntu" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://code.google.com']);" target="_blank">InstallationOnMythBuntu</a> page.</p>
<p>I&#8217;m going to build a custom version of <code>ffmeg</code>, separate to that installed with my Ubuntu system. The instructions below aren&#8217;t intended to be the cleanest solution, but get the job done.</p>
<pre class="brush: bash; title: ; notranslate" title="">
sudo apt-get install build-essential git-core yasm checkinstall zlib1g-dev pkg-config
</pre>
<p>And we&#8217;ll do this work as the <code>mythtv</code> user in a new directory:</p>
<pre class="brush: bash; title: ; notranslate" title="">
sudo mkdir -p /usr/local/lib/ffmpeg-264
sudo chown mythtv:mythtv /usr/local/lib/ffmpeg-264
sudo su - mythtv
cd /usr/local/lib/ffmpeg-264
</pre>
<p>Build the faac library:</p>
<pre class="brush: bash; title: ; notranslate" title="">
cd /usr/local/lib/ffmpeg-264
wget http://downloads.sourceforge.net/project/faac/faac-src/faac-1.28/faac-1.28.tar.gz
tar -zxvf faac-1.28.tar.gz
cd faac-1.28
./configure --prefix=/usr/local/lib/ffmpeg-264 --enable-static --disable-shared
# some kind of gcc-compatibility bug which needs fixing
sed -i -e &quot;s|^char \*strcasestr.*|//&#92;&#48;|&quot; common/mp4v2/mpeg4ip.h
make &amp;&amp; make install
</pre>
<p>Build the x264 library:</p>
<pre class="brush: bash; title: ; notranslate" title="">
cd /usr/local/lib/ffmpeg-264
git clone git://git.videolan.org/x264.git
cd x264
./configure --prefix=/usr/local/lib/ffmpeg-264 --enable-static --disable-shared
make &amp;&amp; make install
</pre>
<p>Build the libmp3lame library:</p>
<pre class="brush: bash; title: ; notranslate" title="">
cd /usr/local/lib/ffmpeg-264
wget http://downloads.sourceforge.net/project/lame/lame/3.98.4/lame-3.98.4.tar.gz
tar -zxvf lame-3.98.4.tar.gz
cd lame-3.98.4
./configure --prefix=/usr/local/lib/ffmpeg-264 --enable-static --disable-shared
make &amp;&amp; make install
</pre>
<p>Build ffmpeg:</p>
<pre class="brush: bash; title: ; notranslate" title="">
cd /usr/local/lib/ffmpeg-264
wget http://www.ffmpeg.org/releases/ffmpeg-0.8.3.tar.gz
tar -zxvf ffmpeg-0.8.3.tar.gz
cd ffmpeg-0.8.3
./configure --prefix=/usr/local/lib/ffmpeg-264 --extra-version=static --disable-debug --enable-static --extra-cflags=--static --disable-ffplay --disable-ffserver --disable-doc --enable-gpl --enable-pthreads --enable-postproc --enable-gray --enable-runtime-cpudetect --enable-libfaac --enable-libmp3lame --enable-libx264 --enable-nonfree --enable-version3 --disable-devices --extra-ldflags=-L/usr/local/lib/ffmpeg-264/lib --extra-cflags=-I/usr/local/lib/ffmpeg-264/include
make &amp;&amp; make install
</pre>
<p>To make life a little easier, I link to this new binary from a more memorable location:</p>
<pre class="brush: bash; title: ; notranslate" title="">
exit # if you are still the &quot;mythtv&quot; user
sudo ln -s /usr/local/lib/ffmpeg-264/bin/ffmpeg /usr/local/bin/ffmpeg-264
</pre>
<p>Now we need a magic incantation for ffmpeg-264 which will result in an H.264 file suitable for iPad playback. A good source of possible command line options is the <a href="http://code.google.com/p/mythpodcaster/source/browse/trunk/src/main/conf/transcoding_profiles.xml" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://code.google.com']);" target="_blank">MythPodcaster trancoding profiles</a> XML file. In this file, the various iPad profiles, as their names suggest, will ask for various formats and qualities of output (see each <code>encoderArguments</code> key).</p>
<p>These command line options in turn refer to ffmpeg <em>presets</em> (via <code>-vpre</code>) which should be shipped with ffmpeg in the <em>ffpresets</em> directory. Some of these might work, but I&#8217;m pretty happy with two presets from an older version of ffmpeg:</p>
<pre class="brush: bash; title: ; notranslate" title="">
mkdir ~mythtv/.ffmpeg
cd ~mythtv/.ffmpeg
wget https://raw.github.com/FFmpeg/FFmpeg/release/0.6/ffpresets/libx264-main.ffpreset
wget https://raw.github.com/FFmpeg/FFmpeg/release/0.6/ffpresets/libx264-medium.ffpreset
</pre>
<p>One problem you might have with ffmpeg options is selection of an audio track in recordings with multiple soundtracks (for example normal, and <a href="http://www.tvhelp.org.uk/audes/whatis.html" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://www.tvhelp.org.uk']);" target="_blank">audio-descriptive</a>). There&#8217;s no easy way to know which you want (and in my settings I force the choice). Here&#8217;s what I settled on, which seems to work OK for SD content, and if you have others please add a comment, below:</p>
<pre class="brush: plain; title: ; notranslate" title="">
-i &lt;infile&gt; -y -map 0:0 -map 0:1 -er 4 -f ipod -acodec libfaac -ac 2 -ab 128k \
    -ar 44100 -deinterlace -vcodec libx264 -vpre medium -vpre main -b 1200k \
    -bt 1200k -maxrate 1200k -bufsize 1200k -level 30 -r 30 -g 90 -async 2 \
    -threads 0 -v 0 &lt;outfile&gt;
</pre>
<p>These parameters are wrapped up in a script, making things easier for MythTV configuration. This file, called <code>h264xcode</code> is also placed in <code>/usr/local/bin</code> (and obviously, season this to taste, for your system&#8217;s recording directories):</p>
<pre class="brush: bash; title: ; notranslate" title="">
#!/bin/bash

CHANID=$1
STARTTIME=$2

INDIR=&quot;/mnt/mythtv-video/Videos/MythTV&quot;
OUTDIR=&quot;/mnt/mythtv-video/Videos/iPad&quot;

PROG=&quot;time nice -n 19 /usr/local/bin/ffmpeg-264&quot;
PARAMS=&quot;-y -map 0:0 -map 0:1 -er 4 -f ipod -acodec libfaac -ac 2 -ab 128k -ar 44100 -deinterlace -vcodec libx264 -vpre medium -vpre main -b 1200k -bt 1200k -maxrate 1200k -bufsize 1200k -level 30 -r 30 -g 90 -async 2 -threads 0 -v 0&quot;

LOG=&quot;/var/log/mythtv/h264xcode.log&quot;
OUTFILE=&quot;${OUTDIR}/${CHANID}_${STARTTIME}&quot;

COMMAND=&quot;${PROG} -i ${INDIR}/${CHANID}_${STARTTIME}.mpg ${PARAMS} ${OUTFILE}.m4v.tmp&quot;

echo &quot;h264xcode: ${COMMAND}&quot; &gt;&gt; $LOG
$COMMAND &gt;&gt; $LOG 2&gt;&amp;1
mv -f ${OUTFILE}.m4v.tmp ${OUTFILE}.m4v &gt;&gt; $LOG 2&gt;&amp;1
rm -f ${OUTFILE}.m4v.tmp &gt;&gt; $LOG 2&gt;&amp;1
</pre>
<p>Let&#8217;s work through what&#8217;s going on, here. The script takes two arguments &#8211; the channel ID and the start time of the recording (we&#8217;ll see how MythTV passes these, later). From them it&#8217;s possible to locate the original recording file on disk, using the <code>$INDIR</code> variable.</p>
<p>Next a simple log is set up, and the proposed ffmpeg-264 command echoed to that file. Finally the command itself is run, with a low system priority (<code>nice -n 19</code>), and the output directed to the log file. The H.264 file is saved in <code>$OUTDIR</code>.</p>
<p>So far so good. All that remains is to let MythTV know about this new user job command, which we&#8217;ll cover in the next article in this series.</p>
<h6><em>Many thanks to Murray Cox, Seb Jacob, and Colin Morey for providing valuable feedback on this post!</em></h6>
			    			</div><!-- .entry-content -->


		<div class="entry-utility">
		    This entry was posted in <a href="../../../../category/mythtv/index.html" title="View all posts in mythtv" rel="category tag">mythtv</a>, <a href="../../../../category/transcoding/index.html" title="View all posts in transcoding" rel="category tag">transcoding</a>. Bookmark the <a href="../../../../index.html%3Fp=577.html" title="Permalink to MythTV Transcoding (3): Transcoding for iPad Playback" rel="bookmark">permalink</a>.		    		</div><!-- .entry-utility -->
		</div><!-- #post-## -->

		<div id="nav-below" class="navigation">
		    <div class="nav-previous"><a href="../../../../index.html%3Fp=575.html" rel="prev"><span class="meta-nav">&larr;</span> Is it silly that tmux is fun?</a></div>
		    <div class="nav-next"><a href="../../../../index.html%3Fp=614.html" rel="next">MythTV Transcoding (4): Add an H.264 Transcode Job <span class="meta-nav">&rarr;</span></a></div>
		</div><!-- #nav-below -->

		
			<div id="comments">


			<h3 id="comments-title">5 Responses to <em>MythTV Transcoding (3): Transcoding for iPad Playback</em></h3>


			<ol class="commentlist">
					<li class="comment even thread-even depth-1" id="li-comment-130">
		<div id="comment-130">
		<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/9a6cbda161215001dbb8dadaa287bd06?s=40&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">Brad</cite> <span class="says">says:</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="../../../../index.html%3Fp=577.html#comment-130">
			September 6, 2012 at 12:59</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>First, thanks! This is really great!</p>
<p>Second, you need to (as root) touch /var/log/mythtv/h264xcode.log and chmod it to mythtv:mythtv. Otherwise the jobs stay in the &#8216;queued&#8217; state because mythtv doesn&#8217;t know about the errors (see below).</p>
<p>Third, you should probably handle errors from ffmpeg so that mythtv knows the status of the job, and so that you&#8217;re not moving unfinished videos to your ipad directory. </p>
<p>Last, thanks again!</p>
</div>

		<div class="reply">
					</div><!-- .reply -->
	</div><!-- #comment-##  -->

	<ul class="children">
	<li class="comment byuser comment-author-oliver bypostauthor odd alt depth-2" id="li-comment-131">
		<div id="comment-131">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/8c48c917cca4f70e7f7bc9b6254cd62d?s=40&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn"><a href="http://gorwits.me.uk/" onclick="javascript:_gaq.push(['_trackEvent','outbound-commentauthor','http://gorwits.me.uk']);"  rel='external nofollow' class='url'>Oliver Gorwits</a></cite> <span class="says">says:</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="../../../../index.html%3Fp=577.html#comment-131">
			September 9, 2012 at 13:05</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>Hi Brad,</p>
<p>Two excellent comments, many thanks. I&#8217;ll make a note to update the example script to handle the ffmpeg return code and pass it to mythtv.</p>
<p>regards,<br />
oliver.</p>
</div>

		<div class="reply">
					</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1" id="li-comment-346">
		<div id="comment-346">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/cdc98901d5e06a43a0aaa28fea715697?s=40&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">David Tranter</cite> <span class="says">says:</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="../../../../index.html%3Fp=577.html#comment-346">
			May 18, 2013 at 19:14</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>I have this all setup but am seeing the job queued as per the first comment from Brad how do I carry out the below suggestions?</p>
<p>you need to (as root) touch /var/log/mythtv/h264xcode.log and chmod it to mythtv:mythtv. Otherwise the jobs stay in the â€˜queuedâ€™ state because mythtv doesnâ€™t know about the errors (see below).</p>
</div>

		<div class="reply">
					</div><!-- .reply -->
	</div><!-- #comment-##  -->

	<ul class="children">
	<li class="comment byuser comment-author-oliver bypostauthor odd alt depth-2" id="li-comment-347">
		<div id="comment-347">
		<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/8c48c917cca4f70e7f7bc9b6254cd62d?s=40&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn"><a href="http://gorwits.me.uk/" onclick="javascript:_gaq.push(['_trackEvent','outbound-commentauthor','http://gorwits.me.uk']);"  rel='external nofollow' class='url'>Oliver Gorwits</a></cite> <span class="says">says:</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="../../../../index.html%3Fp=577.html#comment-347">
			May 19, 2013 at 19:33</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>As root (you may have to sudo):</p>
<p><code>touch /var/log/mythtv/h264xcode.log</code><br />
<code>chmod mythtv.mythtv /var/log/mythtv/h264xcode.log</code></p>
</div>

		<div class="reply">
					</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1" id="li-comment-484">
		<div id="comment-484">
		<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/f949fdc092e5826700668d1bf0b6f76d?s=40&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D40&amp;r=G' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn"><a href="https://twitter.com/BrianPickford" onclick="javascript:_gaq.push(['_trackEvent','outbound-commentauthor','']);"  rel='external nofollow' class='url'>Brian Pickford</a></cite> <span class="says">says:</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="../../../../index.html%3Fp=577.html#comment-484">
			December 29, 2013 at 17:47</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>I&#8217;ve followed this guide and enjoyed the results, thanks for your efforts in documenting this.<br />
To make it work on Mythbuntu 12.04LTS I had to compile Yasm from source. I guess this issue will disappear with the next LTS.</p>
<p>Additionally to use this with mythexport, I added the following to a file called /usr/share/mythexport/configs/TabTrans.pm</p>
<p><code><br />
#!/usr/bin/perl </p>
<p># Update this with a package name relivant to your new config, make sure it matches with the file name (without the extension).<br />
package TabTrans;</p>
<p>use ExportBase;</p>
<p>our @ISA = qw(ExportBase);</p>
<p>#Example strings, replace with something relivant to your new config.<br />
my $description = "h264xcode default settings.";<br />
my $devices = "Tablet and superphone";<br />
my $notes = "Requires custom ffmpeg build, see <a href="../../../../index.html%3Fp=577.html"  rel="nofollow">http://blog.gorwits.me.uk/2011/09/04/mythtv-transcoding-3-transcoding-for-ipad-playback/</a>";<br />
my $version = "1.0";</p>
<p>#Inherit our base class.<br />
sub new{<br />
    my $class = shift;<br />
    my $self = $class-&gt;SUPER::new(shift, shift, $description, $devices, $notes, $version);<br />
    bless $self, $class;<br />
    return $self;<br />
}</p>
<p>sub export{<br />
    my( $self ) = @_;</p>
<p>    # Any command can go here, below is an example of ffmpeg, but you can use anything you would like.<br />
    # Available variables are inputFile, outputFile, and extension<br />
#   system("ffmpeg -i \'$self-&gt;{_inputFile}\' -y -pass 1 -an -vcodec libx264 -vpre slowfirstpass -vpre ipod640 -b 1500kb -bt 1000kb -threads 0 -s 800x480 -aspect 16:9 -f$<br />
system("time nice -n 19 /usr/local/bin/ffmpeg-264 -i \'$self-&gt;{_inputFile}\' -y -map 0:0 -map 0:1 -er 4 -f ipod -acodec libfaac -ac 2 -ab 128k -ar 44100 -deinterlace -vc$</p>
<p>}</p>
<p>#Feel free to use or extend anything from the base class.</p>
<p>1;<br />
</code></p>
</div>

		<div class="reply">
					</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
			</ol>



								
</div><!-- #comments -->


	    </div><!-- #content -->
	</div><!-- #container -->

	<div id="primary" class="widget-area" role="complementary">
	    <ul class="xoxo">

<li id="search-2" class="widget-container widget_search"><form role="search" method="get" id="searchform" class="searchform" action="../../../../index.html">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form></li><li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href='../../../../2014/03/index.html' title='March 2014'>March 2014</a></li>
	<li><a href='../../../../2013/01/index.html' title='January 2013'>January 2013</a></li>
	<li><a href='../../../../2012/12/index.html' title='December 2012'>December 2012</a></li>
	<li><a href='../../../../2012/09/index.html' title='September 2012'>September 2012</a></li>
	<li><a href='../../../../2012/08/index.html' title='August 2012'>August 2012</a></li>
	<li><a href='../../../../2012/06/index.html' title='June 2012'>June 2012</a></li>
	<li><a href='../../../../2012/04/index.html' title='April 2012'>April 2012</a></li>
	<li><a href='../../../../2012/01/index.html' title='January 2012'>January 2012</a></li>
	<li><a href='../../../11/index.html' title='November 2011'>November 2011</a></li>
	<li><a href='../../../10/index.html' title='October 2011'>October 2011</a></li>
	<li><a href='../../index.html' title='September 2011'>September 2011</a></li>
	<li><a href='../../../08/index.html' title='August 2011'>August 2011</a></li>
	<li><a href='../../../07/index.html' title='July 2011'>July 2011</a></li>
	<li><a href='../../../06/index.html' title='June 2011'>June 2011</a></li>
	<li><a href='../../../05/index.html' title='May 2011'>May 2011</a></li>
	<li><a href='../../../04/index.html' title='April 2011'>April 2011</a></li>
	<li><a href='../../../03/index.html' title='March 2011'>March 2011</a></li>
	<li><a href='../../../02/index.html' title='February 2011'>February 2011</a></li>
	<li><a href='../../../01/index.html' title='January 2011'>January 2011</a></li>
	<li><a href='../../../../2010/11/index.html' title='November 2010'>November 2010</a></li>
	<li><a href='../../../../2010/09/index.html' title='September 2010'>September 2010</a></li>
		</ul>
</li><li id="categories-2" class="widget-container widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-6"><a href="../../../../category/blogging/index.html" title="View all posts filed under blogging">blogging</a>
</li>
	<li class="cat-item cat-item-28"><a href="../../../../category/cats/index.html" title="View all posts filed under cats">cats</a>
</li>
	<li class="cat-item cat-item-16"><a href="../../../../category/databases/index.html" title="View all posts filed under databases">databases</a>
</li>
	<li class="cat-item cat-item-13"><a href="../../../../category/devops/index.html" title="View all posts filed under devops">devops</a>
</li>
	<li class="cat-item cat-item-21"><a href="../../../../category/git/index.html" title="View all posts filed under git">git</a>
</li>
	<li class="cat-item cat-item-7"><a href="../../../../category/htpc/index.html" title="View all posts filed under htpc">htpc</a>
</li>
	<li class="cat-item cat-item-24"><a href="../../../../category/kerberos/index.html" title="View all posts filed under kerberos">kerberos</a>
</li>
	<li class="cat-item cat-item-8"><a href="../../../../category/linux/index.html" title="View all posts filed under linux">linux</a>
</li>
	<li class="cat-item cat-item-19"><a href="../../../../category/monitoring/index.html" title="View all posts filed under monitoring">monitoring</a>
</li>
	<li class="cat-item cat-item-11"><a href="../../../../category/mythtv/index.html" title="View all posts filed under mythtv">mythtv</a>
</li>
	<li class="cat-item cat-item-20"><a href="../../../../category/netdisco/index.html" title="View all posts filed under netdisco">netdisco</a>
</li>
	<li class="cat-item cat-item-10"><a href="../../../../category/networking/index.html" title="View all posts filed under networking">networking</a>
</li>
	<li class="cat-item cat-item-27"><a href="../../../../category/opinion/index.html" title="View all posts filed under opinion">opinion</a>
</li>
	<li class="cat-item cat-item-18"><a href="../../../../category/os-x/index.html" title="View all posts filed under OS X">OS X</a>
</li>
	<li class="cat-item cat-item-9"><a href="../../../../category/perl/index.html" title="View all posts filed under perl">perl</a>
</li>
	<li class="cat-item cat-item-17"><a href="../../../../category/personal/index.html" title="View all posts filed under personal">personal</a>
</li>
	<li class="cat-item cat-item-22"><a href="../../../../category/productivity/index.html" title="View all posts filed under productivity">productivity</a>
</li>
	<li class="cat-item cat-item-15"><a href="../../../../category/python/index.html" title="View all posts filed under python">python</a>
</li>
	<li class="cat-item cat-item-14"><a href="../../../../category/radius/index.html" title="View all posts filed under radius">radius</a>
</li>
	<li class="cat-item cat-item-26"><a href="../../../../category/sysops/index.html" title="View all posts filed under sysops">sysops</a>
</li>
	<li class="cat-item cat-item-12"><a href="../../../../category/transcoding/index.html" title="View all posts filed under transcoding">transcoding</a>
</li>
	<li class="cat-item cat-item-29"><a href="../../../../category/video/index.html" title="View all posts filed under video">video</a>
</li>
	<li class="cat-item cat-item-23"><a href="../../../../category/virtualization/index.html" title="View all posts filed under virtualization">virtualization</a>
</li>
	<li class="cat-item cat-item-25"><a href="../../../../category/windows/index.html" title="View all posts filed under windows">windows</a>
</li>
		</ul>
</li><li id="syndication" class="widget-container Syndication_widget_syndication_widget"><h3 class="widget-title">Syndication</h3><ul>
<li>
<a  title='RSS Feed' href='../../../../index.html%3Ffeed=rss2'/>RSS</a></li>
<li>
<a title='ATOM Feed' href='../../../../index.html%3Ffeed=atom'/>ATOM</a></li>
<li>
<a title='POML Feed' href='../../../../wp-links-opml.php'/>OPML</a></li>
</ul>
</li>			</ul>
	</div><!-- #primary .widget-area -->

    </div><!-- #main -->
        	<div id="footer">
		<div id="colophon">

<table id='ttw_ftable'><tr>
 <td id='ttw_ftdl'><div id="site-info">
 &copy; 2014 - <a href="../../../../index.html" title="Cats and Code" rel="home">Cats and Code</a>
 </div></td>  <td id='ttw_ftdr'><div id="site-generator">
  <a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">Proudly powered by WordPress.</a>
 2010 Weaver by WPWeaver.info
 </div></td> </tr></table>
		</div><!-- #colophon -->
	</div><!-- #footer -->
            
</div><!-- #wrapper -->

<script type='text/javascript' src='../../../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js%3Fver=3.0.83c'></script>
<script type='text/javascript' src='../../../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushBash.js%3Fver=3.0.83c'></script>
<script type='text/javascript' src='../../../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPlain.js%3Fver=3.0.83c'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://blog.gorwits.me.uk/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83c";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://blog.gorwits.me.uk/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83c";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['auto-links'] = false;
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.defaults['wrap-lines'] = false;
	SyntaxHighlighter.all();
</script>
</body>
</html>
